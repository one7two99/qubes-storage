#!/bin/bash
set -euo pipefail

BASEPATH="/home/user/shared"
read REL || { echo "Missing path" >&2; exit 2; }

SAFE="$(realpath -m "$BASEPATH/$REL")"
if [[ "$SAFE" != "$BASEPATH"* || ! -e "$SAFE" ]]; then
  echo "Invalid path" >&2
  exit 2
fi

stat -- "$SAFE"
